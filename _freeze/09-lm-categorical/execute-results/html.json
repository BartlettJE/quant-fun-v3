{
  "hash": "c93ede41fcc1a50d654e0593c791de23",
  "result": {
    "markdown": "# Regression with one categorical predictor\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\nIntroduction.\n\n**Chapter Intended Learning Outcomes (ILOs)**\n\nBy the end of this chapter, you will be able to: \n\n- Visualise the difference between two groups on an outcome. \n\n- ILO2.\n\n## Chapter preparation\n\n### Introduction to the data set \n\nFor most of this chapter, we are using open data from @lopez_visual_2023. The abstract of their article is:\n\n> Imagine a bowl of soup that never emptied, no matter how many spoonfuls you ate—when and how would you know to stop eating? Satiation can play a role in regulating eating behavior, but research suggests visual cues may be just as important. In a seminal study by Wansink et al. (2005), researchers used self-refilling bowls to assess how visual cues of portion size would influence intake. The study found that participants who unknowingly ate from self-refilling bowls ate more soup than did participants eating from normal (not self-refilling) bowls. Despite consuming 73% more soup, however, participants in the self-refilling condition did not believe they had consumed more soup, nor did they perceive themselves as more satiated than did participants eating from normal bowls. Given recent concerns regarding the validity of research from the Wansink lab, we conducted a preregistered direct replication study of Wansink et al. (2005) with a more highly powered sample (N = 464 vs. 54 in the original study). We found that most results replicated, albeit with half the effect size (d = 0.45 instead of 0.84), with participants in the self-refilling bowl condition eating significantly more soup than those in the control condition. Like the original study, participants in the selfrefilling condition did not believe they had consumed any more soup than participants in the control condition. These results suggest that eating can be strongly controlled by visual cues, which can even override satiation.\n\nIn summary, they replicated an (in)famous experiment that won the Ig-Nobel prize. Participants engaged in a intricate setting (seriously, go and look at the diagrams in the article) where they ate soup from bowls on a table. In the control group, participants could eat as much soup as they wanted and could ask for a top-up from the researchers. In the experimental group, the soup bowls automatically topped up through a series of hidden tubes under the table. The idea behind the control group is they get an accurate visual cue by the soup bowl reducing, and the experimental group get an inaccurate visual cue by the soup bowl seemingly never reducing.\n\nIn the original article, participants in the experimental group ate more soup than participants in the control group, but the main author was involved in a series of research misconduct cases. @lopez_visual_2023 wanted to see if the result would replicate in an independent study, so they predicted they would find the same results. In this chapter, we will explore the difference between the control and experimental groups on several variables in their data set. \n\n### Organising your files and project for the chapter\n\nBefore we can get started, you need to organise your files and project for the chapter, so your working directory is in order.\n\n1. In your folder for research methods and the book `ResearchMethods1_2/Quant_Fundamentals`, create a new folder called `Chapter_09_regression_categorical`. Within `Chapter_09_regression_categorical`, create two new folders called `data` and `figures`.\n\n2. Create an R Project for `Chapter_09_regression_categorical` as an existing directory for your chapter folder. This should now be your working directory.\n\n3. Create a new R Markdown document and give it a sensible title describing the chapter, such as `09 t-tests and Regression`. Delete everything below line 10 so you have a blank file to work with and save the file in your `Chapter_09_regression_categorical` folder. \n\n4. We are working with a new data set, so please save the following data file: [Lopez_2023.csv](data/Lopez_2023.csv). Right click the link and select \"save link as\", or clicking the link will save the files to your Downloads. Make sure that you save the file as \".csv\". Save or copy the file to your `data/` folder within `Chapter_09_regression_categorical`.\n\nYou are now ready to start working on the chapter! \n\n### Activity 1 - Read and wrangle the data\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\nAs the first activity, try and test yourself by completing the following task list to practice your data wrangling skills. In this example, there is not loads to do, you just need to tidy up some variables. Create a final object called `lopez_clean` to be consistent with the tasks below. If you want to focus on t-tests and regression, then you can just type the code in the solution. \n\n::: {.callout-tip}\n#### Try this\n\nTo wrangle the data, complete the following tasks: \n\n1. Load the following packages:\n\n    - <pkg>tidyverse</pkg>\n    \n    - <pkg>effectsize</pkg>\n    \n    - <pkg>performance</pkg>\n\n2. Read the data file `data/Lopez_2023.csv` to the object name `lopez_data`.\n\n3. Create a new object called `lopez_clean` based on `lopez_data`:\n\n    - Modify the variable `Condition` to turn it into a factor. \n    \n    - Create a new variable called `Condition_label` by recoding `Condition`. \"0\" is the \"Control\" group and \"1\" is the \"Experimental\" group. \n\nYour data should look like this to be ready to analyse:\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output .cell-output-stdout}\n```\nRows: 464\nColumns: 10\n$ ParticipantID      <dbl> 1002, 1004, 1007, 1016, 1018, 1021, 1022, 1024, 102…\n$ Sex                <dbl> 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 1, 1, …\n$ Age                <dbl> 18, 19, 19, 21, 20, 20, 21, 21, 19, 20, 21, 20, 21,…\n$ Ethnicity          <dbl> 7, 3, 3, 4, 1, 3, 1, 6, 4, 7, 1, 3, 3, 4, 7, 2, 3, …\n$ OzEstimate         <dbl> 3.0, 2.0, 1.0, 3.0, 5.0, 1.0, 1.0, 3.0, 4.0, 1.0, 4…\n$ CalEstimate        <dbl> 65, 10, 20, 25, 50, 5, 20, 180, 470, 50, 130, 100, …\n$ M_postsoup         <dbl> 3.3, 3.1, 43.4, 5.5, 6.0, 0.8, 3.8, 4.5, 7.9, 8.1, …\n$ F_CaloriesConsumed <dbl> 73.19441, 68.75839, 962.61743, 121.99069, 133.08075…\n$ Condition          <fct> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …\n$ Condition_label    <chr> \"Control\", \"Control\", \"Control\", \"Control\", \"Contro…\n```\n:::\n:::\n\n\n:::\n\n::: {.callout-caution collapse=\"true\"}\n#### Show me the solution\nYou should have the following in a code chunk: \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# load the relevant packages\nlibrary(effectsize)\nlibrary(performance)\nlibrary(tidyverse)\n\n# Read the Lopez_2023.csv file \nlopez_data <- read_csv(\"data/Lopez_2023.csv\")\n\n# turn condition into a factor and recode\nlopez_clean <- lopez_data %>% \n  mutate(Condition = as.factor(Condition),\n         Condition_label = case_match(Condition,\n                                      \"0\" ~ \"Control\",\n                                      \"1\" ~ \"Experimental\"))\n```\n:::\n\n\n:::\n\n### Activity 2 - Explore the data {#09-explore}\n\n::: {.callout-tip}\n#### Try this\nAfter the wrangling steps, try and explore `lopez_clean` to see what variables you are working with. For example, opening the data object as a tab to scroll around, explore with `glimpse()`, or try plotting some of the individual variables. \n:::\n\nIn `lopez_clean`, we have the following variables:\n\n| Variable       |       Type                       |           Description          |\n|:--------------:|:---------------------------------|:-------------------------------|\n| ParticipantID | double| Participant ID number. |\n| Sex | double| Participant sex. |\n| Age | double| Participant age in years. |\n| Ethnicity  | double| Participant ethnicity. |\n| OzEstimate | double| Estimated soup consumption in ounces (Oz). |\n| CalEstimate | double| Estimated soup consumption in calories (kcals). |\n| M_postsoup | double| Actual soup consumption in ounces (Oz). |\n| F_CaloriesConsumed | double| Actual soup consumption in calories (kcals). |\n| Condition | integer| Condition labelled numerically as 0 (Control) and 1 (Experimental). |\n| Condition_label | character| Condition as a direct label: Control and Experimental. |\n\nWe will use this data set to demonstrate t-tests and regression when you have one categorical predictor. \n\n## Comparing differences using the t-test \n\nLike correlations are a specific application of the general linear model for the relationship between two continuous variables, t-tests are a specific application for the difference between two groups. Before we demonstrate how you can express this kind of design as a regression model, we cover t-tests so you know how to calculate and interpret them when you come across them in your research. \n\n### Activity 3 - Visualising the difference \n\nTo visualise the difference between two groups, it is useful to create something like a boxplot early for yourself, then provide a more professional looking violin-boxplot to help communicate your results. For most of the demonstrations in this chapter, we will try and answer the research question: \"Is there a difference in actual calories consumed between the control and experimental groups?\"\n\n::: {.callout-tip}\n#### Try this\n\nUsing your data visualisation skills from Chapter 7, recreate the scatterplot below using the variables `F_CaloriesConsumed` and `Condition_label` from `lopez_clean`. \n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](09-lm-categorical_files/figure-html/unnamed-chunk-5-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\nLooking at the graph, the <select class='webex-select'><option value='blank'></option><option value=''>Control</option><option value='answer'>Experimental</option></select> group consumed more calories on average.\n:::\n\n::: {.callout-caution collapse=\"true\"}\n#### Show me the solution\nThe violin-boxplot shows the experimental group who had the biased visual cues consumed more soup in calories than the control group who had the accurate visual cues. \n\nYou should have the following in a code chunk: \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlopez_clean %>% \n  ggplot(aes(y = F_CaloriesConsumed, x = Condition_label, fill = Condition_label)) +\n  geom_violin(alpha = 0.5) + \n  geom_boxplot(width = 0.2, \n               fatten = NULL) + \n  stat_summary(fun = \"mean\", \n               geom = \"point\") +\n  stat_summary(fun.data = \"mean_cl_boot\", # confidence interval\n               geom = \"errorbar\", \n               width = 0.1) +\n  scale_fill_viridis_d(option = \"E\") + \n  scale_y_continuous(name = \"Actual Calories Consumed (kcals)\") +\n  scale_x_discrete(name = \"Study Condition\") + \n  guides(fill = FALSE) + \n  theme_classic()\n```\n:::\n\n\n:::\n\n### Activity 4 - Using the `t.test()` function\n\nA t-test is a specific application of the general linear model. In this test, we express the difference in an outcome between two groups as a kind of standardised mean difference. If you are interested, see the Handy Workbook ([McAleer, 2023](https://psyteachr.github.io/handyworkbook/between-subjects-students-t-test.html){target=\"_blank\"}) for the calculations behind the Student and Welch t-test. Conceptually, a t-test is the difference between two groups divided by the variability of the difference. There are two main versions of a t-test:\n\n- <a class='glossary' title=''>Student t-test</a>\n\n- <a class='glossary' title=''>Welch t-test</a>\n\nThere is a function built into R to calculate the t-test: `t.test()`. The function requires:\n\n- Blah. \n\n- Blah.\n\nFor our `lopez_clean` data, we would run the following code for a two-tailed Welch t-test:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nt.test(F_CaloriesConsumed ~ Condition, \n       data = lopez_clean)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tWelch Two Sample t-test\n\ndata:  F_CaloriesConsumed by Condition\nt = -4.8578, df = 453.45, p-value = 1.638e-06\nalternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0\n95 percent confidence interval:\n -88.55610 -37.54289\nsample estimates:\nmean in group 0 mean in group 1 \n       196.6818        259.7313 \n```\n:::\n:::\n\n\nFor the three key concepts of inferential statistics, we get \n\n- **Hypothesis testing**: X \n\n- **Effect size**: X\n\n- **Confidence interval**: [-0.75, -0.64], X\n\nTo summarise: X\n\nWhen you have statistics software like R to do the heavy lifting for you, there is not really a scenario where you would use the Student t-test anymore, but if you did, you can use the `var.equal` argument to say you assume there are equal variances in each group:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nt.test(F_CaloriesConsumed ~ Condition, \n       data = lopez_clean, \n       var.equal = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tTwo Sample t-test\n\ndata:  F_CaloriesConsumed by Condition\nt = -4.8625, df = 462, p-value = 1.591e-06\nalternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0\n95 percent confidence interval:\n -88.52983 -37.56915\nsample estimates:\nmean in group 0 mean in group 1 \n       196.6818        259.7313 \n```\n:::\n:::\n\n\n### Activity 5 - Calculating Cohen's d \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ncohens_d(F_CaloriesConsumed ~ Condition, data = lopez_clean)\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|   Cohens_d|   CI|     CI_low|    CI_high|\n|----------:|----:|----------:|----------:|\n| -0.4523004| 0.95| -0.6366884| -0.2674345|\n\n</div>\n:::\n:::\n\n\n## Linear regression with one categorical predictor\n\n### Activity 6 - Descriptive statistics\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlopez_clean %>% \n  group_by(Condition) %>% \n  summarise(mean_cals = mean(F_CaloriesConsumed),\n            sd_cals = mean(F_CaloriesConsumed))\n```\n\n::: {.cell-output-display}\n<div class=\"kable-table\">\n\n|Condition | mean_cals|  sd_cals|\n|:---------|---------:|--------:|\n|0         |  196.6818| 196.6818|\n|1         |  259.7313| 259.7313|\n\n</div>\n:::\n:::\n\n\n### Activity 7 - Using the `lm()` function\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlm_cals <- lm(F_CaloriesConsumed ~ Condition, data = lopez_clean)\n\nsummary(lm_cals)\n\nlm_cals <- lm(F_CaloriesConsumed ~ Condition_label, data = lopez_clean)\n\nsummary(lm_cals)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = F_CaloriesConsumed ~ Condition, data = lopez_clean)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-230.90  -99.09  -24.15   62.83  828.04 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  196.682      8.888  22.130  < 2e-16 ***\nCondition1    63.049     12.966   4.863 1.59e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 139.4 on 462 degrees of freedom\nMultiple R-squared:  0.04869,\tAdjusted R-squared:  0.04663 \nF-statistic: 23.64 on 1 and 462 DF,  p-value: 1.591e-06\n\n\nCall:\nlm(formula = F_CaloriesConsumed ~ Condition_label, data = lopez_clean)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-230.90  -99.09  -24.15   62.83  828.04 \n\nCoefficients:\n                            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                  196.682      8.888  22.130  < 2e-16 ***\nCondition_labelExperimental   63.049     12.966   4.863 1.59e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 139.4 on 462 degrees of freedom\nMultiple R-squared:  0.04869,\tAdjusted R-squared:  0.04663 \nF-statistic: 23.64 on 1 and 462 DF,  p-value: 1.591e-06\n```\n:::\n:::\n\n\n\n### Activity 8 - Calculating confidence intervals\n\nTry this\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlm_cal_est <- lm(CalEstimate ~ Condition, data = lopez_clean)\n\nsummary(lm_cal_est)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = CalEstimate ~ Condition, data = lopez_clean)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-130.03  -83.03  -33.03   44.85  666.97 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  133.033      7.679  17.324   <2e-16 ***\nCondition1   -17.883     11.192  -1.598    0.111    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 119.9 on 459 degrees of freedom\n  (3 observations deleted due to missingness)\nMultiple R-squared:  0.005531,\tAdjusted R-squared:  0.003365 \nF-statistic: 2.553 on 1 and 459 DF,  p-value: 0.1108\n```\n:::\n:::\n\n\n### Activity 9 - Standardising predictors\n\n## Checking assumptions\n\n## Reporting your results\n\n## One- and paired-sample tests\n\n## Test Yourself\n\nTo end the chapter, we have some knowledge check questions to test your understanding of the concepts we covered in the chapter. We then have some error mode tasks to see if you can find the solution to some common errors in the concepts we covered in this chapter. \n\n### Knowledge check\n\nFor this chapter's knowledge check section, we have something a little different. Instead of purely conceptual questions about functions, we have another example of linear regression from X. Feel free to create this model yourself, but we will show you some output and ask you questions based on it. \n\nFor this model...\n\n**Question 1**.\n\n**Question 2**.\n\n**Question 3**.\n\n**Question 4**.\n\n**Question 5**.\n\n### Error mode\n\nThe following questions are designed to introduce you to making and fixing errors. For this topic, we focus on simple linear regression between two continuous variables. There are not many outright errors that people make here, more misspecifications that are not doing what you think they are doing. \n\nCreate and save a new R Markdown file for these activities. Delete the example code, so your file is blank from line 10. Create a new code chunk to load <pkg>tidyverse</pkg> and wrangle the data files: \n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\nBelow, we have several variations of a misspecification. Copy and paste them into your R Markdown file below the code chunk to wrangle the data. Once you have copied the activities, click knit and look at the output you receive. See if you can identify the mistake and fix it before checking the answer.\n\n**Question 6**.\n\n## Words from this Chapter\n\nBelow you will find a list of words that were used in this chapter that might be new to you in case it helps to have somewhere to refer back to what they mean. The links in this table take you to the entry for the words in the [PsyTeachR Glossary](https://psyteachr.github.io/glossary/){target=\"_blank\"}. Note that the Glossary is written by numerous members of the team and as such may use slightly different terminology from that shown in the chapter.\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n|term                                             |definition |\n|:------------------------------------------------|:----------|\n|[student-t-test](https://psyteachr.github.io/glossary/s#student-t-test){target='_blank' class='glossary'}|           |\n|[welch-t-test](https://psyteachr.github.io/glossary/w#welch-t-test){target='_blank' class='glossary'}|           |\n:::\n:::\n\n\n## End of chapter\n\nBlah...\n",
    "supporting": [
      "09-lm-categorical_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}