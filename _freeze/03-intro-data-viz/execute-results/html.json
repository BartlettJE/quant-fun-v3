{
  "hash": "4a43f2e634d1aa2195534f709ff01162",
  "result": {
    "engine": "knitr",
    "markdown": "# Introduction to Data Visualisation {#c03-intro-data-viz}\n\n\n\n\n::: {.cell layout-align=\"center\"}\n\n:::\n\n\nIn this chapter, we introduce you to...\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![](03-intro-data-viz_files/figure-html/unnamed-chunk-2-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n\n**Chapter Intended Learning Outcomes (ILOs)**\n\n- ILO1\n\n## Chapter preparation\n\n### Introduction to the data set \n\nFrom now on, we are going to use different data sets from psychology to develop and practice your data skills. This will prepare you for working with different kinds of psychology data and introduce you to different kinds of research questions they might ask. For this chapter, we are using @woodworth_data_2018. The abstract of their article is: \n\n> We present two datasets. The first dataset comprises 992 point-in-time records of self-reported happiness and depression in 295 participants, each assigned to one of four intervention groups, in a study of the effect of web-based positive-psychology interventions. Each point-in-time measurement consists of a participant’s responses to the 24 items of the Authentic Happiness Inventory and to the 20 items of the Center for Epidemiological Studies Depression (CES-D) scale. Measurements were sought at the time of each participant’s enrolment in the study and on five subsequent occasions, the last being approximately 189 days after enrolment. The second dataset contains basic demographic information about each participant.\n\nIn summary, we have two files containing demographic information about participants and measurements of two scales on happiness and depression: \n\n- The Authentic Happiness Inventory (AHI), \n\n- The Center for Epidemiological Studies Depression (CES-D) scale. \n\n### Organising your files and project for the chapter\n\nBefore we can get started, you need to organise your files and project for the chapter, so your working directory is in order. If you need a refresher of this process, you can look back over Chapter 2 - [File structure, working directories, and R Projects](#02-projects). \n\n1. In your folder for research methods and the book `ResearchMethods1_2/Quant_Fundamentals`, create a new folder called `Chapter_03_intro_data_viz`. Within `Chapter_03_intro_data_viz`, create two new folders called `data` and `figures`.\n\n2. Create an R Project for `Chapter_03_intro_data_viz` as an existing directory for your chapter folder. This should now be your working directory.\n\n3. Create a new R Markdown document and give it a sensible title describing the chapter, such as `03 Introduction to Data Visualisation`. Delete everything below line 10 so you have a blank file to work with and save the file in your `Chapter_03_intro_data_viz` folder. \n\n4. Download these two data files which we used at the end of Chapter 2. Data file one: [ahi-cesd.csv](data/ahi-cesd.csv). Data file two: [participant-info.csv](data/participant_info.csv). Right click the links and select \"save link as\", or clicking the links will save the files to your Downloads. Make sure that both files are saved as \".csv\". Do not open them on your machine as often other software like Excel can change setting and ruin the files. Save or copy the file to your `data/` folder within `Chapter_03_intro_data_viz`.\n\nYou are now ready to start working on the chapter! \n\n**Add hidden guidance for people using the server** \n\n## Loading the `tidyverse` and reading data files \n\n### Activity 1 - Loading the `tidyverse` package\n\nFor everything we do in this chapter and almost every chapter from now, we need to use the **<a href='https://psyteachr.github.io/glossary/t#tidyverse' target='_blank' class='glossary' title='A set of R packages that help you create and work with tidy data'>tidyverse</a>** package. The `tidyverse` is a package of packages, containing a kind of ecosystem of functions that work together for **<a href='https://psyteachr.github.io/glossary/d#data-wrangling' target='_blank' class='glossary' title='The process of preparing data for visualisation and statistical analysis.'>data wrangling</a>**, **<a href='https://psyteachr.github.io/glossary/d#descriptive' target='_blank' class='glossary' title='Statistics that describe an aspect of data (e.g., mean, median, mode, variance, range)'>descriptive</a>** statistics, and visualisation. So let's load that package into our library using the `library()` function.\n\nTo load the `tidyverse`, below line 10 of your RMarkdown document, create a code chunk, type the following code into your code chunk, and run the code:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n:::\n\n\nRemember that sometimes in the **<a href='https://psyteachr.github.io/glossary/c#console' target='_blank' class='glossary' title='The pane in RStudio where you can type in commands and view output messages.'>console</a>** or below your code chunk, you will see information about the package you have loaded. If you see an error message, be sure to read it and try to identify what the problem is. For example, if you are working on your own computer, have you installed `tidyverse` so R/RStudio can access it? Are there any spelling mistakes? \n\nRemember though, not all messages are errors, `tidyverse` explains what packages it loaded and highlights function name clashes. See [activity 3](#install-tidy) and 4 from Chapter 1 if you need a refresher. \n\n### Activity 2 - Reading data files using `read_csv()`\n\nNow we have loaded `tidyverse`, we can read in the data we need for the remaining activities. \"Read\" in this sense just means to bring the data into RStudio and store it in an **<a href='https://psyteachr.github.io/glossary/o#object' target='_blank' class='glossary' title='A word that identifies and stores the value of some data for later use.'>object</a>**, so we can work with it. \n\nWe will use the function `read_csv()` that allows us to read in **<a href='https://psyteachr.github.io/glossary/c#csv' target='_blank' class='glossary' title='Comma-separated variable: a file type for representing data where each variable is separated from the next by a comma.'>.csv files</a>**. There are also functions that allow you to read in Excel files (e.g. .xlsx) and other formats, but in this course we will only use .csv files as they are not software specific, meaning they are more accessible to share, promoting our open science principles.\n\n::: {.callout-note collapse=\"true\"}\n#### Where does `read_csv()` come from? \n\nWhen we describe tidyverse as a package of packages, the `read_csv()` function comes from a package called `readr`. This is one of the packages that tidyverse loads and contains several functions for reading different kinds of data. \n:::\n\nCreate a new code chunk below where you loaded `tidyverse`, type the following code, and run the code chunk: \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\ndat <- read_csv(\"data/ahi-cesd.csv\")\n\npinfo <- read_csv(\"data/participant-info.csv\")\n```\n:::\n\n\nTo break down the code:\n\n- First, we create an object called `dat` that contains the data in the `ahi-cesd.csv` file within `data/`.\n\n- Next, we create an object called `pinfo` that contains the data in the `participant-info.csv` file within `data/`.\n\n- Both lines have the same format of `object <- function(\"folder/datafile_name.csv\")`\n\n::: {.callout-important}\n#### Error mode\n\nThere are several common mistakes that can happen here, so be careful how you are typing the code to read in the data. \n\n- You need the double quotation marks around the data file name, so R recognises you are giving it a file path.\n\n- Computers are literal, so you must spell the data file name correctly. For example, R would not know what `data/participant-inf.csv` is. This is where pressing the tab key on your keyboard can be super helpful, as you can search and auto-complete your files and avoid spelling mistakes.   \n\n- For the same reason as spelling mistakes, you must add the .csv part on the end to tell R the specific file you want. \n\n- You must point R to the right folder relative to your working directory. If you typed `ahi-cesd.csv`, you would receive an error as R would look in your chapter folder where `ahi-cesd.csv` does not exist, rather than within the `data/` folder you stored it in. \n:::\n\n- Remember that `<-` is called the **<a href='https://psyteachr.github.io/glossary/a#assignment-operator' target='_blank' class='glossary' title='The symbol &lt;-, which functions like = and assigns the value on the right to the object on the left'>assignment operator</a>** but we can read it as \"assigned to\". For example, the first line can be read as the data in `data/ahi-cesd.csv` is assigned to the object called `dat`.\n\nIf you have done this activity correctly, you should now see the objects `dat` and `pinfo` in the **<a href='https://psyteachr.github.io/glossary/e#environment' target='_blank' class='glossary' title='A data structure that contains R objects such as variables and functions'>environment</a>** window in the top right of RStudio. If they are not there, check there are no error messages, check the spelling of the code and file names, and check your working directory is set to `Chapter_03_intro_data_viz`.\n\n::: {.callout-warning}\n#### Be careful to use the right `read_csv()` function\n\nThere is also a function called `read.csv()`. Be very careful **not** to use this function instead of `read_csv()` as they have different ways of naming columns. For the activities and the assignments in RM1 and RM2, we will always ask and expect you to use `read_csv()`. This is really a reminder to watch spelling on functions and to be careful to use the right functions, especially when the names are so close.\n:::\n\n### Wrangling the two data sets\n\nFor this final preparation step, we would like you to add the following to the code chunk below where you read the two data files. We are not tackling data wrangling until the next chapter, so we are not going to fully explain the code just yet.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nall_dat <- inner_join(dat, \n                      pinfo, \n                      by= c(\"id\", \"intervention\"))\n\nsummarydata <- select(.data = all_dat, \n                      ahiTotal, \n                      cesdTotal, \n                      sex, \n                      age, \n                      educ, \n                      income, \n                      occasion, \n                      elapsed.days)\n```\n:::\n\n\nFor a brief overview, we are joining the two data files by common columns (\"id\" and \"intervention\") to create the object `all_dat`. We are then selecting 8 columns from the original 54 to make the data easier to work with in `summarydata`. This final object `summarydata` is the source of the data we will be working with for the rest of this chapter. \n\n## ggplot2 and the layer system\n\nThere are multiple approaches to data visualisation in R; in this workshop we use `ggplot2`, which uses a layered grammar of graphics, in which plots are built up in a series of layers. It may be helpful to think about any picture as having multiple elements that sit over each other.\n\nImportantly, each layer is independent and independently customisable. For example, the size, colour, and position of each component can be adjusted. The use of layers makes it easy to build up complex plots step-by-step, and to adapt or extend plots from existing code. Each layer is separated by a `+`. We'll try this by making a simple histogram next!\n\n## Histogram\n\nWe are going to plot the distribution of participant age in a histogram, and add layers one-by-one to demonstrate how the plot is built step-by-step.\n\nStep 1: This code tells R to access the `ggplot` function. The first argument tells R to plot the `dat` dataframe. In the `aes` function, you specify the aesthetics of the plot, such as the axes and colours. What you need to specify depends on the plot you want to make (you'll learn more about this later) - for a basic histogram you only need to specify the x-axis (the y-axis will automatically be counts). \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(summarydata, aes(x = age))\n```\n\n::: {.cell-output-display}\n![](03-intro-data-viz_files/figure-html/histogram1-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\nStep 2: You can see that the code above produces an empty plot - that's because we haven't specified which type of plot we want to make. We'll do this by adding another layer: `geom_histogram()`. `Geom` is an expression of the type of plot you want to create.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(summarydata, aes(x = age)) +\n  geom_histogram()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](03-intro-data-viz_files/figure-html/histogram2-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\nStep 3: By adding a new layer we can change the axis names:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(summarydata, aes(x = age)) +\n  geom_histogram()+\n  scale_x_continuous(\"Age\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](03-intro-data-viz_files/figure-html/histogram3-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\nStep 4: We can also change the theme of the plot:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(summarydata, aes(x = age)) +\n  geom_histogram()+\n  scale_x_continuous(\"Age\")+\n  theme_bw()\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](03-intro-data-viz_files/figure-html/histogram4-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n## Density plot\n\nThe layer system makes it easy to create new types of plots by adapting existing recipes. For example, rather than creating a histogram, we can create a smoothed density plot by calling `geom_density()` rather than `geom_histogram()`. The rest of the code remains identical.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(summarydata, aes(x = age)) +\n  geom_density()+\n  scale_x_continuous(name = \"Age\")+\n  theme_bw()\n```\n\n::: {.cell-output-display}\n![Density plot of age.](03-intro-data-viz_files/figure-html/density-rt-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n## Data visualisation\n\n<a class='glossary' title='A graphical representation of your data set.'>Data Visualisation</a>. Being able to visualise our data, and relationships between our variables, is an incredibly useful and important skill. Before we do any statistical analyses or present any summary statistics, we should visualise our data as it is:\n\n1. A quick and easy way to check our data make sense, and to identify any unusual trends.\n\n2. A way to honestly present the features of our data to anyone who reads our research.\n\n3. A means of checking that our data fits with the assumptions of our <a href='https://psyteachr.github.io/glossary/d#descriptive' target='_blank' class='glossary' title='Statistics that describe an aspect of data (e.g., mean, median, mode, variance, range)'>descriptive</a> and <a href='https://psyteachr.github.io/glossary/i#inferential' target='_blank' class='glossary' title='Statistics that allow you to make predictions about or comparisons between data (e.g., t-value, F-value, rho)'>inferential</a> tests and of the statistical analyses that we intend to use.\n\nAs Grolemund and Wickham tell us in [R for Data Science](http://r4ds.had.co.nz/introduction.html){target=\"_blank\"}:\n\n> Visualisation is a fundamentally human activity. A good visualisation will show you things that you did not expect, or raise new questions about the data. A good visualisation might also hint that you’re asking the wrong question, or you need to collect different data. Visualisations can surprise you, but don’t scale particularly well because they require a human to interpret them.\n\nThe main package we use for visualisation within the `tidyverse` umbrella is called **`ggplot2`** and the main starting function of all visualisations is `ggplot()`. The reason we say the \"main starting function\" is that `ggplot()` builds plots by combining layers (see, for example, Figure \\@ref(fig:img-layers) from [@nordmann2021]) - i.e. one function creates the first layer, the basic plot area, and you add functions and arguments to add additional layers such as the data, the labels, the colors, etc. If you're used to making plots in other software this might seem a bit odd at first, however, it means that you can customise each layer separately in order to make very complex and beautiful figures with relative ease. You can get a sense of what is possible from ([this website](https://www.data-to-viz.com/) but we will start off slow and build as we go!\n\n\n::: {.cell layout-align=\"center\"}\n::: {.cell-output-display}\n![Building a figure using the ggplot2 layers system as shown in Nordmann et al. (2021)](images/layers2.PNG){fig-align='center' width=100%}\n:::\n:::\n\n\n## Setting up to Visaulise\n\nWe will use the same files from @woodworth_data_2018 as in Chapter 2 - Creating reproducible documents - as you already know what the data contains, so we can focus just on visualising it. \n\n#### Activity 1: Set-up {#introviz-a1}\n\nThis data contains happiness and depression scores:\n\n* Download <a href=\"ahi-cesd.csv\" download>`ahi-cesd.csv`</a> and <a href=\"participant-info.csv\">`participant-info.csv`</a> into the folder on your computer for this chapter! \n    * Make sure that you have downloaded both .csv files above and saved them in your chapter folder. Remember not to change the file names at all and that `data.csv` is not the same as `data (1).csv`.\n* Open RStudio and set the working directory to your chapter folder. Ensure the environment is clear.  \n    * If you're on the server, avoid a number of issues by restarting the session - click `Session` - `Restart R` \n* Open a new R Markdown document and save it in your working directory. Call the file \"DataVisualisation1\".    \n* Delete the default R Markdown welcome text and insert a new code chunk. \n* Type and run the below code to load the `tidyverse` package and to load in the data files. \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nlibrary(tidyverse) \n\ndat <- read_csv(\"ahi-cesd.csv\")\npinfo <- read_csv(\"participant-info.csv\")\n\nall_dat <- inner_join(dat, \n                      pinfo, \n                      by= c(\"id\", \"intervention\"))\nsummarydata <- select(.data = all_dat, \n                      ahiTotal, \n                      cesdTotal, \n                      sex, \n                      age, \n                      educ, \n                      income, \n                      occasion, \n                      elapsed.days) \n```\n:::\n\n\nYou should have a good idea about what this code is doing but if not here is a brief summary:\n\n1. It loads in the tidyverse\n2. It reads both datafiles as tibbles into separate objects, `dat` and `pinfo`.\n3. Joins the data together into one larger tibble and stores it in the object called `all_dat`\n4. Select a number of columns to keep in our data and discards others.\n\n## Dealing with Factors and Categories\n\nBefore we go any further we need to perform an additional step of data processing that we have glossed over up until this point. First, run the below code to look at the structure of the dataset:\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nglimpse(summarydata)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 992\nColumns: 8\n$ ahiTotal     <dbl> 32, 34, 34, 35, 36, 37, 38, 38, 38, 38, 39, 40, 41, 41, 4…\n$ cesdTotal    <dbl> 50, 49, 47, 41, 36, 35, 50, 55, 47, 39, 45, 47, 33, 27, 3…\n$ sex          <dbl> 1, 1, 1, 1, 1, 1, 2, 1, 2, 2, 1, 2, 1, 2, 2, 1, 1, 1, 1, …\n$ age          <dbl> 46, 37, 37, 19, 40, 49, 42, 57, 41, 41, 52, 41, 52, 58, 5…\n$ educ         <dbl> 4, 3, 3, 2, 5, 4, 4, 4, 4, 4, 5, 4, 5, 5, 5, 4, 3, 4, 3, …\n$ income       <dbl> 3, 2, 2, 1, 2, 1, 1, 2, 1, 1, 2, 1, 3, 2, 2, 3, 2, 2, 2, …\n$ occasion     <dbl> 5, 2, 3, 0, 5, 0, 2, 2, 2, 4, 4, 0, 4, 0, 1, 4, 0, 5, 4, …\n$ elapsed.days <dbl> 182.025139, 14.191806, 33.033831, 0.000000, 202.096887, 0…\n```\n\n\n:::\n:::\n\n\nYou can see that all the variables are automatically considered as <a href='https://psyteachr.github.io/glossary/n#numeric' target='_blank' class='glossary' title='A data type representing a real decimal number or integer.'>numeric</a> (in this case <a href='https://psyteachr.github.io/glossary/d#double' target='_blank' class='glossary' title='A data type representing a real decimal number'>double</a> represented by `<dbl>`). This is going to be a problem because whilst the different categories within `sex`, `educ`, and `income` are represented by numbers, we don't want to treat them as such because they are categories, or what we call **factors**. So to get around this, we need to convert these variables into <a href='https://psyteachr.github.io/glossary/f#factor-data-type' target='_blank' class='glossary' title='A data type where a specific set of values are stored with labels'>factor data type</a>. Fortunately we already know a good function for this! We can use `mutate()` to do this by overriding the original variable with the same data but classified as a factor. \n\n### Activity 2: Factors {#introviz-a2}\n\n* Type and run the below code to change the categories to factors.\n    * You can read each line of the mutate as \"overwrite the data that is in that column with the same values now considered factors and not doubles\"\n    * So for example, the 1s in `sex` change to categorical factors instead of numerical 1s.\n    * Remember if you mutate a new column with the same name as the old one, it will overwrite the column.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nsummarydata <- summarydata %>%\n  mutate(sex = as.factor(sex),\n         educ = as.factor(educ),\n         income = as.factor(income))\n```\n:::\n\n\nThis is a very important step to remember if, when you look at your data, some of your categories are represented as numbers and not factors. If you do not do this then you might end up with some really confused looking figures!\n\n## Barplots\n\nOk great, we are now ready to do some visualising and some plotting. For our first example we will create a barplot of our data showing the number of male and female participants within our data. A <a class='glossary' title='also known as a bar chart, barplots represent the frequency or count of a variable through the height of one or more bars.'>barplot</a> is a plot that shows counts of categorical data, or factors, where the height of each bar represents the count of that particular variable.\n\n#### Activity 3: Bar plot {#introviz-a3}\n\nRead through the following section and try the different code chunks. Following this, and changing parts of the code to see what happens, will help you to see how the layers build up.\n\n**The first layer**\n\n* The first line (or layer) sets up the base of the graph: the data to use and the aesthetics (what will go on the x and y axis, how the plot will be grouped).    \n* `aes()` can take both an `x` and `y` argument, however, with a bar plot you are just asking R to count the number of data points in each group so you don't need to specify this. \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(summarydata, aes(x = sex))\n```\n\n::: {.cell-output-display}\n![First ggplot() layer sets the axes](03-intro-data-viz_files/figure-html/layer1-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n* The next layer adds a **geom** or a shape, in this case we use `geom_bar()` as we want to draw a bar plot. \n    * Note that we are adding layers, using a `+` between layers. This is a very important difference between pipes and visualisation. We will mention this again later but we add layers (`+`), we do not pipe them!\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(summarydata, aes(x = sex)) +\n  geom_bar()\n```\n\n::: {.cell-output-display}\n![Basic barplot with geom_bar() added](03-intro-data-viz_files/figure-html/unnamed-chunk-7-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n* Adding `fill` to the first layer will separate the data into each level of the grouping variable and give it a different colour. In this case, there is a different coloured bar for each level of `sex`.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(summarydata, aes(x = sex, fill = sex)) +\n  geom_bar()\n```\n\n::: {.cell-output-display}\n![Barplot with colour](03-intro-data-viz_files/figure-html/unnamed-chunk-8-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\n* As you can see, adding the `fill()` has also produced a plot legend to the right of the graph. When you have multiple grouping variables you want legends to know which groups each color or part of the plot is referring to, but in this case it is redundant because it doesn't tell us anything that the axes labels don't already. We can get rid of it by adding `show.legend = FALSE` to the `geom_bar()` code.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(summarydata, aes(x = sex, fill = sex)) +\n  geom_bar(show.legend = FALSE)\n```\n\n::: {.cell-output-display}\n![Barplot without legend](03-intro-data-viz_files/figure-html/unnamed-chunk-9-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\nExcellent. So far so good! But we might want to tidy up our plot to make it look a bit nicer. First we can edit the axis labels to be more informative. The most common functions you will use are:\n\n* `scale_x_continuous()` for adjusting the x-axis for a continuous variable\n* `scale_y_continuous()` for adjusting the y-axis for a continuous variable\n* `scale_x_discrete()` for adjusting the x-axis for a discrete/categorical variable\n* `scale_y_discrete()` for adjusting the y-axis for a discrete/categorical variable\n\nAnd in those functions the two most common arguments you will use are:\n\n* `name` which controls the name of each axis - i.e. what is the overall variable called for example (e.g. Groups)\n* `labels` which controls the names of the break points on the axis - i.e. what are the conditions within a variable called for example (e.g. dogs and cats)\n\nThere are lots more ways you can customise your axes but we will stick with these for now. \n\n* Type out and and run the below code to change the axes labels and change the numeric sex codes (the 1s and 2s) into words (Female and Male).\n    * **Note:** We are using `scale_x_discrete()` because our x-axis is a discrete variable in this data (Female or Male), and we are using `scale_y_continuous()` because our y-axis is continuous in this data (a count of how many people there are)\n    * **Note:** The `labels` arguments must be written in the correct order of your data. Here it will make the 1's Female and the 2's Male, but if you flipped the order of Male and Female, it would make the 1's Male and the 2's Female. Remember the code does what you tell it to do so always check your output!\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(summarydata, aes(x = sex, fill = sex)) +\n  geom_bar(show.legend = FALSE) +\n  scale_x_discrete(name = \"Participant Sex\", \n                   labels = c(\"Female\", \n                              \"Male\")) +\n  scale_y_continuous(name = \"Number of participants\")\n```\n\n::: {.cell-output-display}\n![Barplot with axis labels](03-intro-data-viz_files/figure-html/unnamed-chunk-10-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\nNow the default colors are ok but you might want to adjust the colours and the visual style of the plot. `ggplot2` comes built a number of different built-in themes as they are called. \n\n* Type the code below into a new code chunk and run it.\n    * Here we use `theme_minimal()` but try changing it to others and see what happens. You start by typing `theme_` into the code chunk, instead of `theme_minimal()`, and trying the options that come up on auto-complete. Examples include, `theme_bw()`, `theme_classic()`, `theme_light()`, etc. \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(summarydata, aes(x = sex, fill = sex)) +\n  geom_bar(show.legend = FALSE) +\n  scale_x_discrete(name = \"Participant Sex\", \n                   labels = c(\"Female\", \n                              \"Male\")) +\n  scale_y_continuous(name = \"Number of participants\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![Barplot with minimal theme](03-intro-data-viz_files/figure-html/unnamed-chunk-11-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\nOk but what about the color of the individual bars of the plot? Well, there are various options to adjust the colours but a good way to be inclusive is to use a colour-blind friendly palette that can also be read if printed in black-and-white. To do this, we can add on the function `scale_fill_viridis_d()`. This function has 5 colour options, A, B, C, D, and E. We like `option = \"E\"` but you can play around with them and choose the one you prefer.\n\n* Type and run the below code into a new code chunk. Try changing the option to either A, B, C or D and see which one you like!\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(summarydata, aes(x = sex, fill = sex)) +\n  geom_bar(show.legend = FALSE) +\n  scale_x_discrete(name = \"Participant Sex\", \n                   labels = c(\"Female\", \n                              \"Male\")) +\n  scale_y_continuous(name = \"Number of participants\") +\n  theme_minimal() +\n  scale_fill_viridis_d(option = \"E\")\n```\n\n::: {.cell-output-display}\n![Barplot with colour-blind friendly colour scheme](03-intro-data-viz_files/figure-html/unnamed-chunk-12-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\nFinally, you can also adjust the transparency of the bars by adding `alpha` to `geom_bar()`. Play around with the value and see what value you prefer.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(summarydata, aes(x = sex, fill = sex)) +\n  geom_bar(show.legend = FALSE, \n           alpha = .8) +\n  scale_x_discrete(name = \"Participant Sex\", \n                   labels = c(\"Female\", \n                              \"Male\")) +\n  scale_y_continuous(name = \"Number of participants\") +\n  theme_minimal() +\n  scale_fill_viridis_d(option = \"E\")\n```\n\n::: {.cell-output-display}\n![Barplot with adjusted alpha](03-intro-data-viz_files/figure-html/unnamed-chunk-13-1.png){fig-align='center' width=100%}\n:::\n:::\n\n\nSo as you can see, with just a few lines of code you can create a very effective figure. The **top tip** we have is to remember a figure is a series of layers, so write the code like that. Avoid trying to write the whole figure from a blank code chunk. Instead, create the first code chunk, run it, add the next layer, run it, add the next layer, run it, etc., etc. That will make it much easier for you to follow what your code is doing and to debug any issues.\n\n\n::: {.cell layout-align=\"center\" type='info'}\n<div class=\"info\">\n<p><strong>We add layers, we don’t pipe them</strong></p>\n<p>We just wanted to remind you of a key point here - that you add\nlayers through <code>+</code> and you do not pipe layers with\n<code>%&gt;%</code>. If you try to pip on a layer you will probably see\nan error that looks something like this:</p>\n<p><strong>Error: <code>mapping</code> must be created by\n<code>aes()</code>. Did you use %&gt;% instead of +?</strong></p>\n<p>Do watch out for that as it is a very common error we see when people\nare first starting to learn to visualise through ggplot2</p>\n</div>\n:::\n\n\n## Saving your Figures\n\nGreat work today! We just want to show you one last very helpful function on how to save and export your figures. Much like your favourite jumper, there is no point having it if nobody gets to see it! It is so useful to be able to save a copy of your plots as an image file so that you can use them in a presentation or report. One approach we can use is the function `ggsave()`.\n\n#### Activity 6: Saving plots {#introviz-a6}\n\nThere are two ways you can use `ggsave()`. If you don't tell `ggsave()` which plot you want to save, by default it will save **the last plot you created**. To demonstrate this let's run the code from Activity 5 again to produce the nice violin-boxplot:\n\nNow that we've got the plot we want to save as our last produced plot, all that `ggsave()` requires is for you to tell it what file name it should save the plot to and the type of image file you want to create (the below example uses .png but you could also use e.g., .jpeg and other image types).\n\n* Type and run the below code into a new code chunk and then check your chapter folder. If you have performed this correctly then you see the saved image file.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n#ggsave(\"violin-boxplot.png\")\n```\n:::\n\n\nNote that the image tends to save at a default size, or the size that the image is displayed in your viewer, but you can change this manually if you think that the dimensions of the plot are not correct or if you need a particular size or file type.\n\n* Type and run the below code to overwrite the image file with new dimensions.\n    * try different dimensions and units to see the difference. You might want to create violin-boxplot-v1, ...-v2, ...-v3, and compare them. Remeber you can use `?ggsave()` in the console window to bring up the help on this function.\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\n# ggsave(\"violin-boxplot.png\", \n#        width = 10, \n#        height = 8, \n#        units = \"in\")\n```\n:::\n\n\nAlternatively, the second way of using `ggsave()` is to save your plot as an object, just like we have done with tibbles, and then tell `ggsave()` which object you want to save. \n\n* Type and run the below code and then check your folder for the image file. Resize the plot if you think it needs it.\n    * The below code saves the plot from Activity 5 into an object named `viobox` and then saves it to an image file \"violin-boxplot-stored.png\". \n    * **Note:** We do not add on `ggsave()`. Instead it is a separate line of code and we tell it which object to save. So, do not do `+ ggsave()`   \n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nviobox <- summarydata %>%\n  ggplot(aes(x = income,\n             y = ahiTotal,\n             fill = income)) +\n  geom_violin(trim = FALSE, \n              show.legend = FALSE, \n              alpha = .4) +\n  geom_boxplot(width = .2, \n               show.legend = FALSE, \n               alpha = .7)+\n  scale_x_discrete(name = \"Income\",\n                   labels = c(\"Below Average\", \n                              \"Average\", \n                              \"Above Average\")) +\n  scale_y_continuous(name = \"Authentic Happiness Inventory Score\")+\n  theme_minimal() +\n  scale_fill_viridis_d()\n\n\nggsave(\"violin-boxplot-stored.png\", plot = viobox)\n```\n:::\n\n\nFinall, note that when you save a plot to an object, you will not see the plot displayed anywhere. To get the figure to display you need to type the object name in the console (i.e., `viobox`). The benefit of saving figures this way is that if you are making lots of plots, you can't accidentally save the wrong one because you are explicitly specifying which plot to save rather than just saving the last one.\n\n## Finished! {#introviz-fin}\n\nWell done! `ggplot` can be a bit difficult to get your head around at first, particularly if you've been used to making graphs a different way. But once it clicks, you'll be able to make informative and professional visualisations with ease, which, amongst other things, will make any report you write look more professional!\n\n## Test Yourself\n\nTo end the chapter, we have some knowledge check questions to test your understanding of the concepts we covered in the chapter. We then have some error mode tasks to see if you find the solution to some common errors in the concepts we covered in this chapter. \n\n### Knowledge check\n\n1. Which of these is the appropriate order of functions to create a boxplot? <div class='webex-radiogroup' id='radio_PAHOUHPCJB'><label><input type=\"radio\" autocomplete=\"off\" name=\"radio_PAHOUHPCJB\" value=\"\"></input> <span>geom_plot() + geom_boxplot()</span></label><label><input type=\"radio\" autocomplete=\"off\" name=\"radio_PAHOUHPCJB\" value=\"\"></input> <span>geom_boxplot() + ggplot()</span></label><label><input type=\"radio\" autocomplete=\"off\" name=\"radio_PAHOUHPCJB\" value=\"\"></input> <span>ggplot() %>% geom_boxplot()</span></label><label><input type=\"radio\" autocomplete=\"off\" name=\"radio_PAHOUHPCJB\" value=\"answer\"></input> <span>ggplot() + geom_boxplot()</span></label></div>\n\n\n2. Would this line of code run, assuming all data and libraries had been loaded in and the data and column names were spelt correctly?\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(summarydata, aes(x = sex, fill = sex)) %>%\n  geom_bar()\n```\n:::\n\n\n<div class='webex-radiogroup' id='radio_SWHQWHCHUQ'><label><input type=\"radio\" autocomplete=\"off\" name=\"radio_SWHQWHCHUQ\" value=\"\"></input> <span>Yes, as the code looks perfectly acceptable and no errors are visible</span></label><label><input type=\"radio\" autocomplete=\"off\" name=\"radio_SWHQWHCHUQ\" value=\"answer\"></input> <span>No, because you have piped the geom_bar() instead of adding it</span></label></div>\n\n\n3. Why would this line of code not create a barplot, assuming all data and libraries had been loaded in and the data and column names were spelt correctly?\n\n\n::: {.cell layout-align=\"center\"}\n\n```{.r .cell-code}\nggplot(summarydata, aes(x = sex, fill = sex)) +\n  geom_barplot()\n```\n:::\n\n\n<div class='webex-radiogroup' id='radio_IDPVPUULTP'><label><input type=\"radio\" autocomplete=\"off\" name=\"radio_IDPVPUULTP\" value=\"answer\"></input> <span>because there is no geom_barplot() and it should be geom_bar()</span></label><label><input type=\"radio\" autocomplete=\"off\" name=\"radio_IDPVPUULTP\" value=\"\"></input> <span>because this would create a boxplot</span></label><label><input type=\"radio\" autocomplete=\"off\" name=\"radio_IDPVPUULTP\" value=\"\"></input> <span>because you have piped the barplot and not added it</span></label><label><input type=\"radio\" autocomplete=\"off\" name=\"radio_IDPVPUULTP\" value=\"\"></input> <span>because you have not included a y axis</span></label></div>\n\n\n4. If I wanted a boxplot on top of a violin plot, what order of functions would I write? <div class='webex-radiogroup' id='radio_IDMVKAJJRQ'><label><input type=\"radio\" autocomplete=\"off\" name=\"radio_IDMVKAJJRQ\" value=\"answer\"></input> <span>ggplot() + geom_violin() + geom_boxplot()</span></label><label><input type=\"radio\" autocomplete=\"off\" name=\"radio_IDMVKAJJRQ\" value=\"\"></input> <span>ggplot() %>% geom_violin() %>% geom_boxplot()</span></label><label><input type=\"radio\" autocomplete=\"off\" name=\"radio_IDMVKAJJRQ\" value=\"\"></input> <span>ggplot() + geom_boxplot() + geom_violin()</span></label><label><input type=\"radio\" autocomplete=\"off\" name=\"radio_IDMVKAJJRQ\" value=\"\"></input> <span>ggplot() %>% geom_boxplot() %>% geom_violin()</span></label></div>\n\n\n\n<div class='webex-solution'><button>Explain these answers</button>\n\n\n::: {.cell layout-align=\"center\"}\n\n`r unhide()`\n\n1. `ggplot() + geom_boxplot()` would be the correct answer as the rest either use pipes, have the wrong order, or have the wrong functions.\n2. The line of code would not run because it uses pipes instead of adding a layer\n3. The line of code would not run because there is no `geom_barplot()` function and it should be `geom_bar()`\n4. The correct order would be `ggplot() + geom_violin() + geom_boxplot()` as the others either use pipes, have the wrong order, or have the wrong functions.\n:::\n\n\n</div>\n\n\n### Error mode\n\nQ5. \n\n## Words from this Chapter\n\nBelow you will find a list of words that were used in this chapter that might be new to you in case it helps to have somewhere to refer back to what they mean. The links in this table take you to the entry for the words in the [PsyTeachR Glossary](https://psyteachr.github.io/glossary/){target=\"_blank\"}. Note that the Glossary is written by numerous members of the team and as such may use slightly different terminology from that shown in the chapter.\n\n\n::: {.cell layout-align=\"center\"}\n\n|term                                                  |definition                                                                                                                 |\n|:-----------------------------------------------------|:--------------------------------------------------------------------------------------------------------------------------|\n|[assignment-operator](https://psyteachr.github.io/glossary/a#assignment-operator){target='_blank' class='glossary'}|The symbol <-, which functions like = and assigns the value on the right to the object on the left                         |\n|[barplot](https://psyteachr.github.io/glossary/b#barplot){target='_blank' class='glossary'}|also known as a bar chart, barplots represent the frequency or count of a variable through the height of one or more bars. |\n|[console](https://psyteachr.github.io/glossary/c#console){target='_blank' class='glossary'}|The pane in RStudio where you can type in commands and view output messages.                                               |\n|[csv](https://psyteachr.github.io/glossary/c#csv){target='_blank' class='glossary'}|Comma-separated variable: a file type for representing data where each variable is separated from the next by a comma.     |\n|[data-visualisation](https://psyteachr.github.io/glossary/d#data-visualisation){target='_blank' class='glossary'}|A graphical representation of your data set.                                                                               |\n|[data-wrangling](https://psyteachr.github.io/glossary/d#data-wrangling){target='_blank' class='glossary'}|The process of preparing data for visualisation and statistical analysis.                                                  |\n|[descriptive](https://psyteachr.github.io/glossary/d#descriptive){target='_blank' class='glossary'}|Statistics that describe an aspect of data (e.g., mean, median, mode, variance, range)                                     |\n|[double](https://psyteachr.github.io/glossary/d#double){target='_blank' class='glossary'}|A data type representing a real decimal number                                                                             |\n|[environment](https://psyteachr.github.io/glossary/e#environment){target='_blank' class='glossary'}|A data structure that contains R objects such as variables and functions                                                   |\n|[factor-data-type](https://psyteachr.github.io/glossary/f#factor-data-type){target='_blank' class='glossary'}|A data type where a specific set of values are stored with labels                                                          |\n|[inferential](https://psyteachr.github.io/glossary/i#inferential){target='_blank' class='glossary'}|Statistics that allow you to make predictions about or comparisons between data (e.g., t-value, F-value, rho)              |\n|[numeric](https://psyteachr.github.io/glossary/n#numeric){target='_blank' class='glossary'}|A data type representing a real decimal number or integer.                                                                 |\n|[object](https://psyteachr.github.io/glossary/o#object){target='_blank' class='glossary'}|A word that identifies and stores the value of some data for later use.                                                    |\n|[tidyverse](https://psyteachr.github.io/glossary/t#tidyverse){target='_blank' class='glossary'}|A set of R packages that help you create and work with tidy data                                                           |\n:::\n\n\n## End of chapter\n\nThat is end of this chapter. Be sure to look again at anything you were unsure about and make some notes to help develop your own knowledge and skills. It would be good to write yourself some questions about what you are unsure of and see if you can answer them later or speak to someone about them. Good work today!\n",
    "supporting": [
      "03-intro-data-viz_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}